<!-- fanuc registry definition -->
<script type="text/x-red" data-template-name="fanuc-registry">
    <div class="form-row">
        <label for="node-input-host"><i class="icon-tag"></i>Hostname</label>
        <input type="text" id="node-input-host" placeholder="host">
    </div>
    <div class="form-row">
        <label for="node-config-input-reg"><i class="icon-tag"></i>Registry</label>
        <select type="text" id="node-config-input-reg" >
            <option value="numreg">numreg</option>
            <option value="strreg">strreg</option>
            <option data-val="1" value="DIN">DIN (digital input)</option>
            <option data-val="2" value="DOUT">DOUT (digital output)</option>
            <option data-val="8" value="RI">RI (robot input)</option>
            <option data-val="9" value="RO">RO (robot output)</option>
            <option data-val="35" value="Flag">Flag</option>
            <option value="SysVar">SysVar</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-config-input-index"><i class="icon-tag"></i>Index</label>
        <input type="text" id="node-config-input-index" placeholder="index" />
    </div>
</script>

<script type="text/x-red" data-help-name="fanuc-registry">
    <p>Fanuc Registry Property/Index combinations</p>
</script>

<!-- getter -->
<script type="text/x-red" data-template-name="robot-socket-get">
    <div class="form-row">
      <label for="node-input-name"><i class="fa fa-tag"></i> Name<span data-i18n="common.label.name"></span></label>
      <input type="text" id="node-input-name" />
    </div>
    <div class="form-row">
        <label for="node-input-regpoint"><i class="icon-tag"></i>Registry</label>
        <select id="node-input-regpoint" ></select>
    </div>
</script>

<script type="text/x-red" data-help-name="robot-socket-get">
    <p>receives getdata.stm from fanuc robot</p>
</script>

<!-- setter -->
<script type="text/x-red" data-template-name="robot-socket-set">
    <div class="form-row">
      <label for="node-input-name"><i class="fa fa-tag"></i> Name<span data-i18n="common.label.name"></span></label>
      <input type="text" id="node-input-name" />
    </div>
    <div class="form-row">
        <label for="node-input-regpoint"><i class="icon-tag"></i>Registry</label>
        <select id="node-input-regpoint" ></select>
    </div>
    <div id="node-input-simulated-block" class="form-row">
        <label for="node-input-simulated"><i class="icon-tag"></i>Simulated</label>
        <select id="node-input-simulated" >
          <option value="1">simulated</option>
          <option value="0">not simulated</option>
        </select>
    </div>
</script>

<script type="text/x-red" data-help-name="robot-socket-set">
    <p>sets registry keys and values for fanuc robot</p>
</script>


<script type="text/javascript">
(function() {
    RED.nodes.registerType('fanuc-registry',{
        category: 'config',
        defaults: {
            host: {value:"127.0.0.1:1880",required:true},
            reg: {value:"",required:true},
            index: {value:"",required:true}
        },
        inputs:0,
        outputs:0,
        label: function() {
            return this.reg + ': ' + this.index;
        },
        oneditprepare: function() {
            $('#node-config-input-reg').change(function() {
                if ($(this).val() == 'SysVar') {
                  $('#node-input-simulated-block').show();
                } else {
                  $('#node-input-simulated-block').hide();
                }
            });
        }
    });

    RED.nodes.registerType('robot-socket-get',{
        category: 'FlexibleAssembly',
        color: '#8eed28',
        defaults: {
            name: {value:""},
            regpoint: {type:"fanuc-registry",required:true}
        },
        inputs:1,
        outputs:1,
        icon: "Robot_Receive2.png",
        label: function() {
            var config =  RED.nodes.node(this.regpoint);
            return this.name || "get " + config.reg + ":" + config.index;
        }
    });

    RED.nodes.registerType('robot-socket-set',{
        category: 'FlexibleAssembly',
        color: '#33d4f4',
        defaults: {
            name: {value:""},
            regpoint: {type:"fanuc-registry",required:true},
            simulated :{value:"notsimulated"}
        },
        inputs:1,
        outputs:1,
        icon: "Robot_Send2.png",
        label: function() {
          var config =  RED.nodes.node(this.regpoint);
          return this.name || "set " + config.reg + ":" + config.index;
        }
    });
})();
</script>
